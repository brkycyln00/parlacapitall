<analysis>**original_problem_statement:**
Kullanıcının hedefi, ParlaCapital adında, Türkçe arayüze sahip, tam donanımlı bir Çok Katmanlı Pazarlama (MLM) kripto yatırım platformu oluşturmaktır.

**Temel Ürün Gereksinimleri:**
- **Kayıt ve Kimlik Doğrulama:** Kullanıcılar e-posta/şifre ile kayıt olabilir. Kayıt sırasında kullanıcı adı istenmez ve e-posta doğruluğu kontrol edilir. Başarılı kayıt sonrası SMTP üzerinden hoş geldin e-postası gönderilir.
- **Yatırım ve Komisyonlar:** Kullanıcılar sadece bir kez yatırım yapabilir. Yatırım talebi yönetici tarafından onaylandığında, sadece direkt sponsor (tek seviye) komisyon kazanır. Çok seviyeli komisyon sistemi uygulanmış ancak sonrasında kullanıcının isteği üzerine geri alınmıştır.
- **Ağ Yönetimi:**
  - **Binary Tree:** Kullanıcılar, referanslarıyla gelen ve başlangıçta yerleştirilmemiş olarak görünen yeni üyeleri, kendi panellerinden interaktif bir şekilde ağaçlarındaki (kendi altları veya kendi altlarındaki başka bir üyenin altı) herhangi bir boş pozisyona (sol/sağ) manuel olarak yerleştirebilir.
  - **Referans Kodu:** Kullanıcılar kendi kodlarını oluşturabilir. Daha önce referanssız kayıt olmuş bir kullanıcı, panelinden tek seferlik olmak üzere başka bir kullanıcının kodunu girerek ağa dahil olabilir.
- **Kullanıcı Paneli (Dashboard):**
  - Kullanıcının bakiyesini, komisyonlarını, ağ hacimlerini gösterir.
  - Yerleştirilmemiş Referanslar bölümü bulunur.
  - Gelişmiş, iç içe açılabilen ve tüm alt üyeleri gösteren, her koldaki toplam yatırım hacmini de içeren bir Referans Ağı görselleştirmesi içerir.
  - Kariyer Hedefleri bölümü, kullanıcının ağ hacmine göre ulaştığı seviyeyi ve bir sonraki hedef için gerekenleri gösterir.
  - Ana site sayfalarına (Anasayfa, Hakkımızda vb.) geçiş linkleri içerir.
- **Yönetici Paneli (Admin Panel):**
  - Bekleyen yatırım talepleri için bir bildirim sayacı bulunur.
  - Onaylanmış yatırım talepleri, kullanıcının tüm form bilgileri ve talep tarihi/saati ile birlikte listelenir.
  - Kullanıcıları ve talepleri yönetme yetkisi vardır.

**User's preferred language**: Turkish

**what currently exists?**
Uygulama, FastAPI (backend) ve React (frontend) kullanılan, tam özellikli bir MLM platformudur. Yukarıda belirtilen tüm temel gereksinimler (manuel binary ağaç yönetimi, kariyer hedefleri, tek yatırım kuralı, yönetici paneli geliştirmeleri, SMTP ile e-posta gönderimi, gelişmiş ağ görselleştirmesi) kodlanmış ve lokal ortamda test edilmiştir. Mobil uyumluluk için arayüzde düzeltmeler yapılmıştır.

**Last working item**:
- **Last item agent was working**: Kullanıcı, siteyi deploy ettikten sonra kullanıcı paneline giriş yapamadığını bildirdi. Ajan, bu tür production sonrası sorunları çözmekte uzman olan  veya 'ı çağırmak üzereydi.
- **Status**: IN PROGRESS
- **Agent Testing Done**: N
- **Which testing method agent to use?**: troubleshoot agent. This is a post-deployment issue, likely related to environment variables, CORS, or proxy configurations, not application logic. Standard testing agents will not be effective.
- **User Testing Done**: Y (User discovered the issue on the deployed site)

**All Pending/In progress Issue list**:
- **Issue 1: Production ortamında kullanıcı girişi yapılamıyor. (P0)**
  - **Attempted fixes**: Henüz bir düzeltme denenmedi. Ajan sorunu yeni teşhis etti.
  - **Next debug checklist**:
    1. 'ı çağırarak deployment log'larını analiz etmesini isteyin.
    2. Production environment'taki  dosyalarını kontrol edin (, ,  vb.). Özellikle frontend'in backend'e doğru URL ile ulaştığından emin olun.
    3. Tarayıcı geliştirici konsolunda network (ağ) hatalarını ve console log'larını inceleyin (CORS, 401, 403, 5xx hataları).
    4. Kubernetes Ingress ve servis konfigürasyonlarını kontrol edin.
  - **Why fix this issue and what will be achieved with the fix?**: Bu, uygulamanın production'da tamamen kullanılamaz olduğu anlamına gelen kritik bir hatadır. Çözülmesi, sitenin canlıya alınmasını ve kullanıcıların sistemi kullanmaya başlamasını sağlayacaktır.
  - **Status**: IN PROGRESS
  - **Is recurring issue?**: N
  - **Should Test frontend/backend/both after fix?**: both (Login flow needs to be tested on the production URL).
  - **Blocked on other issue**: None

**In progress Task List**:
Bu oturumda devam eden bir görev bulunmamaktadır.

**Upcoming and Future Tasks**
- **Future Tasks**:
    - **Canlı Ödeme Entegrasyonu (P1)**: Mevcut statik cüzdan adresleri ve manuel onay süreci yerine, USDT, BTC ve ETH için gerçek bir kripto ödeme ağ geçidi entegrasyonu yapılması.

**Completed work in this session**
- **Ağ Yönetimi Geliştirmeleri**:
  - **Kullanıcı Taraflı Ağ Yönetimi**: Admin paneli yerine her kullanıcının kendi Yerleştirilmemiş Referanslarını kendi Dashboard'undan ağacındaki herhangi birinin (sadece direkt altı değil) altına yerleştirmesi sağlandı.
  - **Sınırsız Referans**: Kayıt sırasında otomatik yerleştirme kaldırılarak, sponsorun iki kolu dolu olsa bile yeni referansların sorunsuzca kaydedilmesi ve daha sonra manuel yerleştirilmesi sağlandı.
  - **Sonradan Ağa Katılma**: Referanssız kayıt olan kullanıcıların, Dashboard üzerinden tek seferlik bir kod girerek bir ağa katılması sağlandı.
  - **Gelişmiş Ağ Görselleştirmesi**: Binary tree şeması, tüm alt üyeleri gösterecek, her koldaki toplam hacmi içerecek ve sınırsız derinliğe sahip olacak şekilde tamamen yenilendi.
- **Komisyon Sistemi Revizyonu**:
  - Başlangıçta istenen çok seviyeli (multi-level) komisyon sistemi kodlandı, ancak daha sonra kullanıcının talebi üzerine **iptal edilerek** sadece direkt sponsora komisyon veren tek seviyeli sisteme geri dönüldü.
- **Kayıt ve Doğrulama**:
  - Kayıt formundan kullanıcı adı alanı kaldırıldı.
  - Pydantic  ile e-posta formatı doğrulaması eklendi.
  - Kayıt olan kullanıcıya SMTP üzerinden formatlanmış bir Hoş Geldin e-postası gönderim altyapısı kuruldu.
- **Yönetici ve Kullanıcı Paneli Özellikleri**:
  - **Tek Yatırım Kuralı**: Kullanıcıların birden fazla yatırım yapması engellendi.
  - **Yönetici Bildirimleri**: Bekleyen yatırım talepleri için Admin paneli başlığında bir bildirim sayacı eklendi.
  - **Detaylı Raporlama**: Admin panelinde Onaylanmış Yatırımlar sekmesi, kullanıcıların tüm form bilgileri ve talep tarihiyle birlikte gösterilecek şekilde güncellendi.
  - **Kariyer Sistemi**: Kullanıcı panelinde, ağ hacmine dayalı Kariyer Hedefleri kartı oluşturuldu ve ilerleme çubuğu eklendi.
  - **Dashboard Navigasyonu**: Kullanıcı paneli kenar çubuğuna ana site sayfalarına (Anasayfa, Hakkımızda vb.) giden linkler eklendi.
- **Hata Düzeltmeleri ve İyileştirmeler**:
  - Mobil cihazlarda kapanan navigasyon menüsü için hamburger menü eklendi ve düzeltildi.
  - Ağaç verisinin yüklenememesine neden olan çift  ön ekli URL hatası düzeltildi.
  - Referans kodu giriş alanındaki  nedeniyle yaşanan sorun giderildi.
  - Çeşitli JSX ve linting hataları temizlendi.
- **Dokümantasyon**:
  - Projenin tüm kodlarını içeren  dosyası oluşturuldu.
  - Turhost için DNS ayarlarını açıklayan  dosyası oluşturuldu.

**Code Architecture**


**Key Technical Concepts**
- **Backend**: FastAPI, Pydantic (EmailStr ile), Motor (Async MongoDB), python-jose (JWT), SMTP (smtplib)
- **Frontend**: React, React Router, Axios, TailwindCSS, 
- **Database**: MongoDB
- **Architecture**: Monolithic RESTful API & Single Page Application (SPA)

**key DB schema**
- : { ..., upline_id, children: {left, right}, ..., **career_level**: str, **career_points**: int, **left_volume**: float, **right_volume**: float, **has_invested**: bool }
- : { ..., **position**: left | right }
- : { ..., user_id, user_email, user_name, package, amount, status, **tx_hash**, **wallet_address**, **created_at**: datetime }

**changes in tech stack**
-  kütüphanesi backend'e eklendi.

**All files**
- **Created/Updated Critical Files**:
  - : Neredeyse tüm özellikler (yeni endpointler, modeller, iş mantığı değişiklikleri) için yoğun şekilde düzenlendi. SMTP, kariyer seviyeleri, tek yatırım kontrolü ve komisyon mantığı geri alma işlemleri burada yapıldı.
  - : En çok değiştirilen dosya. İnteraktif ağ yönetimi, gelişmiş ağaç görselleştirmesi, kariyer kartı, sonradan ağa katılma modal'ı ve çok sayıda state/fonksiyon eklendi.
  - : Bildirim sayacı ve onaylanmış yatırımlar için detaylı tablo eklendi.
  - : Mobil uyumluluk için hamburger menü mantığı eklendi.
  - : SMTP ayarları için yeni değişkenler eklendi (, , , ).
  -  ve : Talep üzerine oluşturulan yeni dokümanlar.

**Areas that need refactoring**:
-  (1500+ satır) ve  (800+ satır) acilen bileşenlere ayrılmalıdır. State yönetimi ve UI mantığı iç içe geçmiş durumdadır. Ağaç görselleştirmesi, modal'lar ve kartlar kendi bileşen dosyalarına taşınmalıdır.
-  (1500+ satır) monolitik bir yapıdadır. API endpoint'leri (routes), veritabanı modelleri (models) ve iş mantığı (services/logic) ayrı dosyalara bölünmelidir.

**key api endpoints**
- : (Admin için) Bir kullanıcıyı başka bir kullanıcının altına yerleştirir.
- : (Kullanıcı için) Kendi yerleştirilmemiş referansını ağacına yerleştirir.
- : Mevcut kullanıcı için tüm ağaç yapısını, üyeleri ve her koldaki toplam hacmi döndürür. Sınırsız derinliğe ayarlanmıştır.
- : Mevcut bir kullanıcının, referans kodu girerek bir ağa katılmasını sağlar.
- : Kullanıcı kaydı. Artık otomatik yerleştirme yapmıyor ve hoş geldin e-postası gönderiyor.
- : Onaylanmış tüm yatırım taleplerini detaylarıyla listeler.

**Critical Info for New Agent**
- **En Önemli Blocker**: Uygulama production'da konuşlandırıldıktan sonra giriş yapılamıyor. Bu sorun lokalde mevcut değil, tamamen production ortamıyla ilgili.
- **Kullanıcı Dinamikleri**: Kullanıcı çok aktif, sık sık yeni fikirler sunuyor ve mevcut özellikler üzerinde değişiklik talep ediyor. Örneğin, çok seviyeli komisyon sistemi uygulandıktan sonra iptal edilmesini istedi. Her adımdan önce onay almak kritiktir.
- **SMTP Yapılandırması**:  dosyasına SMTP değişkenleri eklendi. E-posta gönderiminin çalışması için bu değişkenlerin production ortamında kullanıcı tarafından sağlanan gerçek değerlerle doldurulması gerekir.
- **Mimari**: Proje, ,  ve  gibi çok büyük monolitik dosyalarla büyüdü. Gelecekteki geliştirmeleri kolaylaştırmak için refactoring düşünülmelidir.

**documents created in this job**
- 
- 

**Last 5 User Messages and any pending user messages**
1.  **Talep**: Production için DNS ayarları ve deploy sonrası URL hakkında bilgi.
    - **Durum**: Tamamlandı. Destek ajanı çağrılarak ve rehber HTML dosyası oluşturularak yanıtlandı.
2.  **Talep**: Deploy ettikten sonra siteye giriş yapamıyorum.
    - **Durum**: **MEVCUT SORUN (P0)**. Ajan, sorunu çözmek için bir sonraki adımı atmak üzereydi.
3.  **Talep**:  dosyasının bir domaine yerleştirilmeye uygun hale getirilmesi.
    - **Durum**: Tamamlandı. Agent, bunun üzerine deployment ile ilgili sorular sordu.
4.  **Talep**: Site için yazılan tüm kodların HTML dökümantasyonu.
    - **Durum**: Tamamlandı.  dosyası oluşturuldu.
5.  **Talep**: Kayıt sırasında email validasyonu, kullanıcı adı alanının kaldırılması ve SMTP ile hoş geldin maili gönderimi.
    - **Durum**: Tamamlandı.

**Project Health Check:**
- **Broken**: Production ortamındaki kullanıcı kimlik doğrulama/giriş akışı.
- **Mocked**: Kripto para ödeme sistemi hala manuel onaya dayalı ve statik cüzdan adresleri kullanıyor. Gerçek bir ödeme ağ geçidi entegre edilmedi.

**Testing status**
- **Testing agent used after significant changes**: YES
- **Troubleshoot agent used after agent stuck in loop**: NO (Ancak son adımda çağrılması planlanıyordu)
- **Test files created**: []
- **Known regressions**: Production'da login fonksiyonunun bozulması.

**Credentials to test flow:**
- **Yönetici Kullanıcı**:
  - E-posta: 
  - Şifre: 
- **Normal Kullanıcı**: Lokal ortamda yeni bir hesap oluşturularak test edilebilir. Production'da şu an kayıt ve giriş yapılamıyor.

**What agent forgot to execute**
- Ajan, kullanıcıdan gelen yoğun ve değişen taleplere odaklandığı için herhangi bir görevi unutmadı. Ancak, projenin en başından beri gelecek görev olarak listelenen **canlı kripto ödeme ağ geçidi entegrasyonu** henüz başlatılmadı.</analysis>
